<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Erin Lee" />
    <meta name="description" content="Welcome to my website">
    <link rel="shortcut icon" type="image/x-icon" href="../../img/favicon.ico">
    <title>Project1</title>
    <meta name="generator" content="Hugo 0.79.0" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="../../css/main.css" />
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,400,200bold,400old" />
    
    <!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
			<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->

    
  </head>

  <body>
    <div id="wrap">
      
      <nav class="navbar navbar-default">
  <div class="container">
    <div class="navbar-header">
      <a class="navbar-brand" href="../../"><i class="fa fa-home"></i></a>
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <div class="navbar-collapse collapse" id="navbar">
      <ul class="nav navbar-nav navbar-right">
      
        
        <li><a href="../../post/">BLOG</a></li>
        
        <li><a href="../../projects/">PROJECTS</a></li>
        
        <li><a href="../../resume/">RESUME</a></li>
        
      
      </ul>
    </div>
  </div>
</nav>

      <div class="container">
        <div class="blog-post">
          <h3>
            <strong><a href="../../project/project1/">Project1</a></strong>
          </h3>
        </div>
 
<div class="blog-title">
          <h4>
         October 17, 2020 
            &nbsp;&nbsp;
            
          </h4>
        </div>

        <div class="panel panel-default">
          <div class="panel-body">
            <div class="blogpost">
              
<link href="../../rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="../../rmarkdown-libs/anchor-sections/anchor-sections.js"></script>
<script src="../../rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="../../rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="../../rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="../../rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="../../rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="../../rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="../../rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="../../rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>


<div id="ye-rim-lee-yl33656" class="section level2">
<h2>Ye Rim Lee ,yl33656</h2>
</div>
<div id="introduction" class="section level2">
<h2>0. Introduction</h2>
<ul>
<li>Write a narrative introductory paragraph or two describing the datasets you have chosen, the variables they contain, how they were acquired, and why they are interesting to you. Expand on potential associations you may expect, if any.</li>
</ul>
<pre class="r"><code># import tidyverse
library(tidyverse)

# import two datasets and glimpse those
six &lt;- read.csv(&quot;/stor/home/yl33656/Police_2016.csv&quot;)
glimpse(six)</code></pre>
<pre><code>## Rows: 150,500
## Columns: 13
## $ IncidntNum &lt;int&gt; 120058272, 120058272, 141059263, 160013662, 160002740, 160…
## $ Category   &lt;fct&gt; WEAPON LAWS, WEAPON LAWS, WARRANTS, NON-CRIMINAL, NON-CRIM…
## $ Descript   &lt;fct&gt; &quot;POSS OF PROHIBITED WEAPON&quot;, &quot;FIREARM, LOADED, IN VEHICLE,…
## $ DayOfWeek  &lt;fct&gt; Friday, Friday, Monday, Tuesday, Friday, Friday, Saturday,…
## $ Date       &lt;fct&gt; 01/29/2016 12:00:00 AM, 01/29/2016 12:00:00 AM, 04/25/2016…
## $ Time       &lt;fct&gt; 11:00, 11:00, 14:59, 23:50, 00:30, 21:35, 00:04, 01:02, 12…
## $ PdDistrict &lt;fct&gt; SOUTHERN, SOUTHERN, BAYVIEW, TENDERLOIN, MISSION, NORTHERN…
## $ Resolution &lt;fct&gt; &quot;ARREST, BOOKED&quot;, &quot;ARREST, BOOKED&quot;, &quot;ARREST, BOOKED&quot;, &quot;NON…
## $ Address    &lt;fct&gt; 800 Block of BRYANT ST, 800 Block of BRYANT ST, KEITH ST /…
## $ X          &lt;dbl&gt; -122.4034, -122.4034, -122.3889, -122.4130, -122.4197, -12…
## $ Y          &lt;dbl&gt; 37.77542, 37.77542, 37.72998, 37.78579, 37.76505, 37.78802…
## $ Location   &lt;fct&gt; &quot;(37.775420706711, -122.403404791479)&quot;, &quot;(37.775420706711,…
## $ PdId       &lt;dbl&gt; 1.200583e+13, 1.200583e+13, 1.410593e+13, 1.600137e+13, 1.…</code></pre>
<pre class="r"><code>eight &lt;- read.csv(&quot;/stor/home/yl33656/Police_2018.csv&quot;)
eight %&gt;% glimpse()</code></pre>
<pre><code>## Rows: 150,000
## Columns: 34
## $ Incident.Datetime                                    &lt;fct&gt; 1/21/2018 13:25,…
## $ Incident.Date                                        &lt;fct&gt; 1/21/2018, 10/15…
## $ Incident.Time                                        &lt;fct&gt; 13:25, 12:30, 12…
## $ Incident.Year                                        &lt;int&gt; 2018, 2018, 2018…
## $ Incident.Day.of.Week                                 &lt;fct&gt; Sunday, Monday, …
## $ Report.Datetime                                      &lt;fct&gt; 1/21/2018 13:37,…
## $ Row.ID                                               &lt;dbl&gt; 62639627175, 726…
## $ Incident.ID                                          &lt;int&gt; 626396, 726287, …
## $ Incident.Number                                      &lt;int&gt; 180054759, 18078…
## $ CAD.Number                                           &lt;int&gt; 180211735, 18288…
## $ Report.Type.Code                                     &lt;fct&gt; II, II, II, II, …
## $ Report.Type.Description                              &lt;fct&gt; Initial, Initial…
## $ Filed.Online                                         &lt;lgl&gt; NA, NA, NA, TRUE…
## $ Incident.Code                                        &lt;int&gt; 27175, 16625, 63…
## $ Incident.Category                                    &lt;fct&gt; &quot;Other Miscellan…
## $ Incident.Subcategory                                 &lt;fct&gt; &quot;Other&quot;, &quot;Drug V…
## $ Incident.Description                                 &lt;fct&gt; &quot;Evading a Polic…
## $ Resolution                                           &lt;fct&gt; Open or Active, …
## $ Intersection                                         &lt;fct&gt; FULTON ST \ SCOT…
## $ CNN                                                  &lt;dbl&gt; 26055000, 307440…
## $ Police.District                                      &lt;fct&gt; Northern, Tender…
## $ Analysis.Neighborhood                                &lt;fct&gt; Western Addition…
## $ Supervisor.District                                  &lt;int&gt; 5, 6, 5, NA, 5, …
## $ Latitude                                             &lt;dbl&gt; 37.77707, 37.777…
## $ Longitude                                            &lt;dbl&gt; -122.4365, -122.…
## $ point                                                &lt;fct&gt; &quot;(37.77706807960…
## $ SF.Find.Neighborhoods                                &lt;int&gt; 23, 21, 25, NA, …
## $ Current.Police.Districts                             &lt;int&gt; 4, 5, 7, NA, 7, …
## $ Current.Supervisor.Districts                         &lt;int&gt; 11, 10, 11, NA, …
## $ Analysis.Neighborhoods                               &lt;int&gt; 39, 36, 3, NA, 1…
## $ HSOC.Zones.as.of.2018.06.05                          &lt;int&gt; NA, 1, NA, NA, N…
## $ OWED.Public.Spaces                                   &lt;int&gt; NA, NA, NA, NA, …
## $ Central.Market.Tenderloin.Boundary.Polygon...Updated &lt;int&gt; NA, 1, NA, NA, N…
## $ Parks.Alliance.CPSI..27.TL.sites.                    &lt;int&gt; NA, NA, NA, NA, …</code></pre>
<p><em>I used two dataset which are San Francisco Crime dataset in 2016-2017 and San Francisco Crime dataset in 2018-2019. They both contains information about the crime in Sanfrancisco. For the 2016 dataset, there are 150,500 rows and 13 columns which are mostly related to category of crimes, descriptions of crimes, locations, police districts, and the time. For the 2018 dataset, there are 223,958 rows and 34 columns, which included almost all of the same columns in 2016 data with different names and some redundant columns which had a lot of NAs in the row. Although the person who uploaded the datasets did not specify the method of gathering those data, but seeing those accurate date and time of the report, I logically assume that the data are from the police departments. They are interesting to me because I heard that despite their high income average, they have huge discrepancy between the rich and the poor, which cause a high crime rates. The potential association would be popularity of the different types of crimes in different police districts because they would have different problems in different areas in San Francisco.</em></p>
</div>
<div id="joiningmerging" class="section level2">
<h2>1. Joining/Merging</h2>
<ul>
<li>Join your datasets into one using a <code>dplyr</code> join function</li>
<li>If you have multiple observations on the joining variable in either dataset, fix this by collapsing via summarize</li>
<li>Discuss the process in words, including why you chose the join you did</li>
<li>Discuss which cases were dropped, if any, and potential problems with this</li>
</ul>
<pre class="r"><code># Because both of the datasets have too many rows,
# I randomly sliced the data for 300 rows each I
# also removed NA
six &lt;- six %&gt;% na.omit() %&gt;% slice_sample(n = 300)
eig &lt;- eight %&gt;% select(2:26) %&gt;% na.omit() %&gt;% slice_sample(n = 300)

# rename the column variables of eig same as six in
# order to use full_join easier
eig &lt;- eig %&gt;% rename(IncidntNum = &quot;Incident.Number&quot;, 
    Category = &quot;Incident.Category&quot;, Descript = &quot;Incident.Description&quot;, 
    DayOfWeek = &quot;Incident.Day.of.Week&quot;, Date = &quot;Report.Datetime&quot;, 
    PdDistrict = &quot;Police.District&quot;, Resolution = &quot;Resolution&quot;, 
    X = &quot;Longitude&quot;, Y = &quot;Latitude&quot;, Location = &quot;point&quot;)
six$Date &lt;- as.Date(six$Date, &quot;%m/%d/%Y&quot;)
eig$Date &lt;- as.Date(eig$Date, &quot;%Y/%m/%d %H:%M:%S&quot;)

# full_join of six and eig in order to lessen the
# amount of data loss. select the columns that are
# relevant
mergedat &lt;- six %&gt;% full_join(eig) %&gt;% select(IncidntNum, 
    Category, Descript, DayOfWeek, Date, PdDistrict, 
    Resolution, X, Y, Location)

# instead of x and y, I changed those into more
# understandable variable names.
mergedat &lt;- mergedat %&gt;% rename(long = &quot;X&quot;, lat = &quot;Y&quot;)

# separate year, month, and date in order to get
# more numeric columns
mergedat &lt;- mergedat %&gt;% separate(&quot;Date&quot;, into = c(&quot;year&quot;, 
    &quot;month&quot;, &quot;date&quot;))
mergedat$year &lt;- as.numeric(mergedat$year)
mergedat$date &lt;- as.numeric(mergedat$date)
mergedat$month &lt;- as.numeric(mergedat$month)

# glimpse the final merged data
glimpse(mergedat)</code></pre>
<pre><code>## Rows: 300
## Columns: 12
## $ IncidntNum &lt;int&gt; 160054462, 166088015, 161016942, 160997163, 160520786, 160…
## $ Category   &lt;fct&gt; OTHER OFFENSES, NON-CRIMINAL, OTHER OFFENSES, LARCENY/THEF…
## $ Descript   &lt;fct&gt; &quot;PROBATION VIOLATION&quot;, &quot;LOST PROPERTY&quot;, &quot;INCIDENT ON SCHOO…
## $ DayOfWeek  &lt;fct&gt; Monday, Sunday, Thursday, Sunday, Saturday, Saturday, Frid…
## $ year       &lt;dbl&gt; 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2016…
## $ month      &lt;dbl&gt; 1, 4, 12, 12, 6, 8, 1, 5, 3, 9, 8, 6, 5, 11, 1, 6, 10, 3, …
## $ date       &lt;dbl&gt; 18, 17, 15, 4, 18, 13, 22, 11, 30, 12, 31, 25, 20, 7, 27, …
## $ PdDistrict &lt;fct&gt; PARK, NORTHERN, INGLESIDE, INGLESIDE, NORTHERN, SOUTHERN, …
## $ Resolution &lt;fct&gt; &quot;ARREST, BOOKED&quot;, &quot;NONE&quot;, &quot;NONE&quot;, &quot;NONE&quot;, &quot;NONE&quot;, &quot;NONE&quot;, …
## $ long       &lt;dbl&gt; -122.4542, -122.4379, -122.4069, -122.4372, -122.4218, -12…
## $ lat        &lt;dbl&gt; 37.74596, 37.80061, 37.71886, 37.72133, 37.77518, 37.78448…
## $ Location   &lt;fct&gt; &quot;(37.7459562953856, -122.454239907613)&quot;, &quot;(37.800607533158…</code></pre>
<p><em>I used a full join in order to minimize the loss of data. There were originally over 100,000 rows in each dataset and 13 columns for 2016 data, and 34 columns for the 2018 data. However, I realized there are lots of unnecessary columns in 2018 dataset which were not matching with 2016 dataset. Therefore, I decided to drop some columns using <code>select()</code>. By dropping some datasets, the potential problems would be the loss of unique columns by each dataset. I also dicided to randomly choose 300 rows from each data because it took too long to print out outputs when I had the original data, but I made sure choosing the rows ramdomly to see more accurate results.</em></p>
</div>
<div id="tidying-rearranging-widelong" class="section level2">
<h2>2. Tidying: Rearranging Wide/Long</h2>
<ul>
<li>Tidy the datasets (using the <code>tidyr</code> functions <code>pivot_longer</code>/<code>gather</code> and/or <code>pivot_wider</code>/<code>spread</code>)</li>
<li>If you data sets are already tidy, be sure to use those functions somewhere else in your project</li>
<li>Document the process (describe in words what was done per the instructions)</li>
</ul>
<pre class="r"><code># the data is already tidy, therefore, I created a
# new dataset that has a row telling you if the
# crime is resolved or not
yes &lt;- mergedat %&gt;% filter(str_detect(Resolution, &quot;ARREST&quot;) | 
    str_detect(Resolution, &quot;NONE&quot;)) %&gt;% mutate(arrest = &quot;yes&quot;)
no &lt;- mergedat %&gt;% filter(str_detect(Resolution, &quot;UNFOUNDED&quot;) | 
    str_detect(Resolution, &quot;ACTIVE&quot;)) %&gt;% mutate(arrest = &quot;no&quot;)


# full join yes and no datasets
yes_no &lt;- yes %&gt;% full_join(no)

# Using pivot wider we can see yes and no values in
# a separate column
yes_no &lt;- yes_no %&gt;% pivot_wider(names_from = &quot;arrest&quot;, 
    values_from = c(&quot;IncidntNum&quot;))
yes_no %&gt;% select(yes, no) %&gt;% summarize_all(n_distinct)</code></pre>
<pre><code>## # A tibble: 1 x 2
##     yes    no
##   &lt;int&gt; &lt;int&gt;
## 1   296     2</code></pre>
<p><em>Since my datasets are already tidy, I generated a new dataset 'yes_no' which has a categorical row which tells if the criminal is arrested or not. I used <code>pivot_wider</code> in order to see yes and no response in the separate columns. From the new dataset <code>yes_no</code>, we can observe that there are 391 crime cases that are resolved and 207 crime cases are not resolved. </em></p>
</div>
<div id="wrangling" class="section level2">
<h2>3. Wrangling</h2>
<ul>
<li>Use all six core <code>dplyr</code> functions in the service of generating summary statistics (18 pts)
<ul>
<li>Use mutate at least once to generate a variable that is a function of at least one other variable</li>
</ul></li>
<li>Compute at least 10 summary statistics for using summarize and summarize with group_by (18 pts)
<ul>
<li>Use at least 5 unique functions inside of summarize (e.g., mean, sd)</li>
<li>At least 2 of these should group by a categorical variable. Create one by dichotomizing a numeric if necessary</li>
<li>If applicable, at least 1 of these should group by two categorical variables</li>
<li>Strongly encouraged to create a correlation matrix with <code>cor()</code> on your numeric variables</li>
</ul></li>
<li>Summarize/discuss all results in no more than two paragraphs (4 pts)</li>
</ul>
<pre class="r"><code># Using mutate, I added columns that tells the
# season of the year
mergedat &lt;- mergedat %&gt;% mutate(season = ifelse(month %in% 
    c(3:5), &quot;spring&quot;, ifelse(month %in% c(6:8), &quot;summer&quot;, 
    ifelse(month %in% c(9:11), &quot;fall&quot;, ifelse(month %in% 
        c(12, 1, 2), &quot;winter&quot;, &quot;NA&quot;)))))
mergedat %&gt;% select(month, season) %&gt;% table()</code></pre>
<pre><code>##      season
## month fall spring summer winter
##    1     0      0      0     23
##    2     0      0      0     20
##    3     0     28      0      0
##    4     0     25      0      0
##    5     0     27      0      0
##    6     0      0     31      0
##    7     0      0     27      0
##    8     0      0     19      0
##    9    19      0      0      0
##    10   25      0      0      0
##    11   26      0      0      0
##    12    0      0      0     30</code></pre>
<pre class="r"><code># Capitalize the character values in Category,
# Descript, PdDistrict, and Resolution in order to
# accurately find the distinct variables
mergedat &lt;- mergedat %&gt;% mutate(Category = toupper(Category), 
    Descript = toupper(Descript), PdDistrict = toupper(PdDistrict), 
    Resolution = toupper(Resolution))

# Group by the Police District so that we can see
# which district has the most crimes
mergedat %&gt;% group_by(PdDistrict) %&gt;% summarize_all(n_distinct) %&gt;% 
    arrange(desc(IncidntNum))</code></pre>
<pre><code>## # A tibble: 10 x 13
##    PdDistrict IncidntNum Category Descript DayOfWeek  year month  date
##    &lt;chr&gt;           &lt;int&gt;    &lt;int&gt;    &lt;int&gt;     &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1 CENTRAL            47       14       29         7     1    12    25
##  2 SOUTHERN           43       15       25         7     1    12    22
##  3 MISSION            35       17       29         7     1    12    21
##  4 NORTHERN           35       10       21         7     1    12    20
##  5 INGLESIDE          34       14       30         7     1    12    21
##  6 BAYVIEW            23       12       22         6     1    12    15
##  7 TARAVAL            23        9       18         7     1    10    15
##  8 PARK               21       12       19         5     1    11    13
##  9 RICHMOND           20        7       12         6     1    10    16
## 10 TENDERLOIN         18       11       17         6     1     9    12
## # … with 5 more variables: Resolution &lt;int&gt;, long &lt;int&gt;, lat &lt;int&gt;,
## #   Location &lt;int&gt;, season &lt;int&gt;</code></pre>
<pre class="r"><code># Group by the Category of the crime to see which
# category of crime is the most common.
mergedat %&gt;% group_by(Category) %&gt;% summarize_all(n_distinct) %&gt;% 
    arrange(desc(IncidntNum))</code></pre>
<pre><code>## # A tibble: 25 x 13
##    Category IncidntNum Descript DayOfWeek  year month  date PdDistrict
##    &lt;chr&gt;         &lt;int&gt;    &lt;int&gt;     &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;      &lt;int&gt;
##  1 LARCENY…         85       14         7     1    12    29         10
##  2 NON-CRI…         38       10         7     1    12    22          9
##  3 OTHER O…         38       19         7     1    12    22          9
##  4 VANDALI…         19        3         6     1    10    18          9
##  5 ASSAULT          18        9         7     1    10    15          8
##  6 WARRANTS         14        3         7     1    11    10          9
##  7 VEHICLE…         13        5         5     1     9    11          8
##  8 BURGLARY         11        9         5     1     7    10          6
##  9 SUSPICI…          9        2         6     1     6     6          6
## 10 DRUG/NA…          7        4         5     1     7     6          5
## 11 WEAPON …          7        6         5     1     6     5          6
## 12 MISSING…          6        2         5     1     6     5          4
## 13 SECONDA…          6        3         3     1     5     6          5
## 14 DRIVING…          4        1         3     1     2     4          3
## 15 FRAUD             4        4         3     1     4     4          4
## 16 ROBBERY           4        2         4     1     4     3          4
## 17 TRESPASS          4        2         4     1     4     4          4
## 18 PROSTIT…          3        2         3     1     3     3          3
## 19 DISORDE…          2        2         2     1     2     1          1
## 20 FORGERY…          2        2         2     1     2     2          2
## 21 STOLEN …          2        1         2     1     2     2          2
## 22 ARSON             1        1         1     1     1     1          1
## 23 RECOVER…          1        1         1     1     1     1          1
## 24 RUNAWAY           1        1         1     1     1     1          1
## 25 SEX OFF…          1        1         1     1     1     1          1
## # … with 5 more variables: Resolution &lt;int&gt;, long &lt;int&gt;, lat &lt;int&gt;,
## #   Location &lt;int&gt;, season &lt;int&gt;</code></pre>
<pre class="r"><code>category &lt;- mergedat %&gt;% group_by(Category) %&gt;% summarize_all(n_distinct) %&gt;% 
    arrange(desc(IncidntNum))

# Group by Police District and Day of Week to see
# the maximum, minimum, variance, average, standard
# deviation, and median of number of crimes.
mergedat %&gt;% group_by(PdDistrict, DayOfWeek) %&gt;% summarize_all(n_distinct) %&gt;% 
    summarize(max = max(IncidntNum), min = min(IncidntNum), 
        var = var(IncidntNum), avg = mean(IncidntNum), 
        sd = sd(IncidntNum), median = median(IncidntNum)) %&gt;% 
    arrange(desc(PdDistrict))</code></pre>
<pre><code>## # A tibble: 10 x 7
##    PdDistrict   max   min   var   avg    sd median
##    &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
##  1 TENDERLOIN     6     1  4     3    2        3  
##  2 TARAVAL        6     1  2.90  3.29 1.70     3  
##  3 SOUTHERN      11     3  5.81  6.14 2.41     6  
##  4 RICHMOND       5     1  2.27  3.33 1.51     3  
##  5 PARK           5     3  0.7   4.2  0.837    4  
##  6 NORTHERN       8     2  4     5    2        5  
##  7 MISSION       12     2 11.7   5    3.42     4  
##  8 INGLESIDE      8     1  5.81  4.86 2.41     5  
##  9 CENTRAL       10     2  7.90  6.71 2.81     7  
## 10 BAYVIEW        8     2  4.97  3.83 2.23     3.5</code></pre>
<pre class="r"><code># Count the number of crimes that the criminals are
# arrested.
mergedat %&gt;% filter(str_detect(Resolution, &quot;ARREST&quot;)) %&gt;% 
    summarize(n())</code></pre>
<pre><code>##   n()
## 1  81</code></pre>
<pre class="r"><code># Count the number of crimes that the criminals are
# not arrested or lost.
mergedat %&gt;% filter(str_detect(Resolution, &quot;ACTIVE&quot;) | 
    str_detect(Resolution, &quot;UNFOUNDED&quot;)) %&gt;% summarize(n())</code></pre>
<pre><code>##   n()
## 1   1</code></pre>
<p><em>For the first output, I used <code>mutate()</code> in order to group the month column into four seasons. The result shows that there is the least crime during the fall. The second part was another use of <code>mutate()</code> function in order to capitalize all character values in Category, Descript, PdDistrict, and Resolution which helped me to solve the problem that was caused because dataset in 2016 was capitalized and dataset in 2018 was not capitalized. It was helpful to see the distinct variables of those columns. For the second output, I used <code>group_by</code> for the Police District so that we can see which district has the most crimes. To enhance the visibility, I used <code>arranged()</code>. The result shows that the Southern Police District had the most incidents and categories of crime. Similarly, for the third output, I grouped by the Category of the crime to see which category of crime is the most common. The result shows that the most common category was larceny/theft.</em></p>
<p><em>For the fourth outcome, I grouped by police district and day of week in order to see maximum, minimum, variance, average, standard deviation, and median of the number of incidents within the groups. The result shows that in the Southern police district the range between minimum and maximum is the greatest, which is shown by their highest number of variance, and standard deviation. For the last output, I counted the number of cases that the criminals are arrested and the cases are resolved, and I also counted the number of cases that the criminals are not arrested yet or unfounded. The result shows that surprisingly there are more unresolved cases than resolved ones. </em></p>
</div>
<div id="visualizing" class="section level2">
<h2>4. Visualizing</h2>
<ul>
<li><p>Create a correlation heatmap of your numeric variables</p></li>
<li><p>Create two effective, polished plots with ggplot</p>
<ul>
<li>Each plot should map 3+ variables to aesthetics</li>
<li>Each plot should have a title and clean labeling for all mappings</li>
<li>Change at least one default theme element and color for at least one mapping per plot</li>
<li>For at least one plot, add more tick marks (x, y, or both) than are given by default</li>
<li>For at least one plot, use the stat=&quot;summary&quot; function</li>
<li>Supporting paragraph or two (for each plot) describing the relationships/trends that are apparent</li>
</ul></li>
</ul>
<pre class="r"><code># heatmap selects the numeric variables and then
# selects those which are somewhat relevant.
cormat &lt;- category %&gt;% select_if(is.numeric) %&gt;% select(-long, 
    -lat, -year, -month, -date, -Resolution) %&gt;% cor(use = &quot;pair&quot;)
tidycor &lt;- cormat %&gt;% as.data.frame %&gt;% rownames_to_column(&quot;var1&quot;) %&gt;% 
    pivot_longer(-1, names_to = &quot;var2&quot;, values_to = &quot;correlation&quot;)

# visualize the correlations(plot the heatmap)
tidycor %&gt;% ggplot(aes(var1, var2, fill = correlation)) + 
    geom_tile() + scale_fill_gradient2(low = &quot;red&quot;, 
    mid = &quot;blue&quot;, high = &quot;orange&quot;) + geom_text(aes(label = round(correlation, 
    2)), color = &quot;black&quot;, size = 4) + theme(axis.text.x = element_text(angle = 90, 
    hjust = 1)) + coord_fixed()</code></pre>
<p><img src="../../project/Project1_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>## ggplot1 Using longitude and latitude columns, we
## can generally locate which Police Districts are
## located.
mergedat %&gt;% ggplot() + geom_point(aes(x = long, y = lat, 
    color = PdDistrict, shape = season)) + ggtitle(&quot;Scatterplot of Police Districts&quot;) + 
    labs(color = &quot;Police District&quot;) + ylab(&quot;Latitude&quot;) + 
    xlab(&quot;Longitude&quot;)</code></pre>
<p><img src="../../project/Project1_files/figure-html/unnamed-chunk-5-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># ggplot2 Group by Police District and day of week
# in order to see general trends of crimes reported
# each day in a week in different police districts.
mergedat %&gt;% group_by(PdDistrict, DayOfWeek) %&gt;% summarize_all(n_distinct) %&gt;% 
    ggplot(aes(x = DayOfWeek, y = IncidntNum, fill = DayOfWeek)) + 
    geom_bar(aes(y = IncidntNum), stat = &quot;summary&quot;, 
        fun = mean) + facet_wrap(~PdDistrict) + theme(axis.title.x = element_blank(), 
    axis.text.x = element_blank(), axis.ticks.x = element_blank()) + 
    ylab(&quot;Number of incidents&quot;) + ggtitle(&quot;Police District Daily Trend&quot;)</code></pre>
<p><img src="../../project/Project1_files/figure-html/unnamed-chunk-5-3.png" width="672" style="display: block; margin: auto;" /> <em>First of all for the dataset, I used category which I grouped by category from the original dataset(mergedat) in order to get more numerical columns. Then, I made a correlation heatmap of my numeric variables such as the number of Day of week, Descripions, Incident IDs, Locations, and Police District. Although most of my numeric datasets had high correlation to each other, the one thing noticeable was that in terms of group by crime categories, if there are more cases(the number of incident cases) there are higher distinct locations. Moreover, the number of seasons was the least correlated to other numerical variables.</em></p>
<p><em>The first plot shows the relationship between the Police districts and the location of the case that was reported with longitude and latitude. I also included a season factor to see in which season the crime occurred. I used longitude as x, latitude as y, police district as a color, and season as shape. The plot was useful to see that generally crime cases reported in the same police district is clustered in similar region. However, there were some exceptions as well. For example, as you can see in the plot, a case in Ingleside region was taken care by northern police district.</em></p>
<p><em>The second plot shows the number of incidents in different police district for each day of week. I used the three variables such as police districts as facet wrap, number of incidents as y, day of week as both color and x. The reason I used day of week twice is because there was a limited space for x variables, and I wanted to make my plot look neat. The plot suggests that besides police districts that are out of San Francisco, park district normally has the least criminal cases, whereas Southern district has the most criminal cases. In terms of the day of week, it is hard to see clear relationship between day of week and number of incidents.</em></p>
</div>
<div id="dimensionality-reduction" class="section level2">
<h2>5. Dimensionality Reduction</h2>
<ul>
<li><p>Either k-means/PAM clustering or PCA (inclusive &quot;or&quot;) should be performed on at least three numeric variables in your dataset</p>
<ul>
<li>All relevant steps discussed in class</li>
<li>A visualization of the clusters or the first few principal components (using ggplot2)</li>
<li>Supporting paragraph or two describing results found</li>
</ul></li>
</ul>
<pre class="r"><code>library(cluster)
library(plotly)

# Finding the best number of cluster for my dataset
pam_dat &lt;- category %&gt;% select(IncidntNum, Descript, 
    Location)
sil_width &lt;- vector()
for (i in 2:10) {
    pam_fit &lt;- pam(pam_dat, k = i)
    sil_width[i] &lt;- pam_fit$silinfo$avg.width
}
ggplot() + geom_line(aes(x = 1:10, y = sil_width)) + 
    scale_x_continuous(name = &quot;k&quot;, breaks = 1:10)</code></pre>
<p><img src="../../project/Project1_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># clustering
final &lt;- category %&gt;% select(IncidntNum, Descript, 
    Location) %&gt;% scale %&gt;% as.data.frame
pam2 &lt;- final %&gt;% pam(2)
pam2$silinfo$avg.width</code></pre>
<pre><code>## [1] 0.7027588</code></pre>
<pre class="r"><code>plot(pam2, which = 2)</code></pre>
<p><img src="../../project/Project1_files/figure-html/unnamed-chunk-6-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>final &lt;- final %&gt;% mutate(cluster = as.factor(pam2$clustering))

# 2-D clustering(number of incidents vs
# descriptions)
ggplot(final, aes(x = IncidntNum, y = Descript, color = cluster)) + 
    geom_point() + ggtitle(&quot;Clustering Analysis&quot;) + 
    xlab(&quot;Number of incidents&quot;) + ylab(&quot;Descriptions&quot;)</code></pre>
<p><img src="../../project/Project1_files/figure-html/unnamed-chunk-6-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># 3-D clustering
final %&gt;% plot_ly(x = ~IncidntNum, y = ~Descript, z = ~Location, 
    color = ~cluster, type = &quot;scatter3d&quot;, mode = &quot;markers&quot;)</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"visdat":{"11fb17f13ec0f":["function () ","plotlyVisDat"]},"cur_data":"11fb17f13ec0f","attrs":{"11fb17f13ec0f":{"x":{},"y":{},"z":{},"mode":"markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"IncidntNum"},"yaxis":{"title":"Descript"},"zaxis":{"title":"Location"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[3.99239056864957,1.4219473258204,1.4219473258204,0.328141690573938],"y":[2.1167650579389,1.23843930775679,3.21467224566655,1.01885787021126],"z":[4.00598669576958,1.3397725887682,1.45086484322659,0.339942298642677],"mode":"markers","type":"scatter3d","name":"1","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"frame":null},{"x":[0.382831972336261,0.109380563524646,0.0546902817623229,-0.0546902817623229,-0.164070845286969,-0.273451408811615,-0.273451408811615,-0.328141690573938,-0.328141690573938,-0.437522254098584,-0.437522254098584,-0.437522254098584,-0.437522254098584,-0.492212535860907,-0.546902817623229,-0.546902817623229,-0.546902817623229,-0.601593099385552,-0.601593099385552,-0.601593099385552,-0.601593099385552],"y":[-0.29863075506192,-0.29863075506192,0.140532120029139,1.01885787021126,-0.518212192607449,-0.0790493175163906,0.360113557574668,-0.518212192607449,-0.29863075506192,-0.737793630152979,-0.0790493175163906,-0.518212192607449,-0.518212192607449,-0.518212192607449,-0.518212192607449,-0.518212192607449,-0.737793630152979,-0.737793630152979,-0.737793630152979,-0.737793630152979,-0.737793630152979],"z":[0.395488425871872,0.117757789725895,0.062211662496699,-0.0488805919616921,-0.159972846420083,-0.271065100878474,-0.271065100878474,-0.32661122810767,-0.32661122810767,-0.437703482566061,-0.437703482566061,-0.437703482566061,-0.437703482566061,-0.493249609795257,-0.548795737024452,-0.548795737024452,-0.548795737024452,-0.604341864253648,-0.604341864253648,-0.604341864253648,-0.604341864253648],"mode":"markers","type":"scatter3d","name":"2","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><em>First of all, I used goodness-of-fit in order to find the best number of clusters for my dataset. The result shows that when it has 2 clusters, it has the highest silhouette width. When I coded silhouette plot of PAM, I got 0.79 for the average silhouette width, which means a strong structure has been found. </em></p>
<p><em>For the visualization of the clusters, I visualized two variables(number of incidents and description), but in cluster based on three variables which are number of incidents, descriptions, locations. The plot shows that although cluster 2(blue) shows a pretty positively correlated relationship between the number of incidents and the number of descriptions, cluster 1(red) doesn't show clear relationship between those two variables. For the second visualization, I included all three variables. Both Descriptions vs Location, and the number of incidents vs Description had strong positive correlations for cluster 2, but they did not have strong correlation for the cluster 1. However, for Location vs number of incidents, both of the clusters had strong positively correlated relationship.</em></p>
<p>Note that the <code>echo = FALSE</code> parameter was added to the code chunk to prevent printing of the R code that generated the plot.</p>
<pre><code>## R version 3.6.1 (2019-07-05)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 18.04.5 LTS
## 
## Matrix products: default
## BLAS:   /stor/system/opt/R/R-3.6.1/lib/R/lib/libRblas.so
## LAPACK: /stor/system/opt/R/R-3.6.1/lib/R/lib/libRlapack.so
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] plotly_4.9.2.1  cluster_2.1.0   forcats_0.5.0   stringr_1.4.0  
##  [5] dplyr_1.0.1     purrr_0.3.4     readr_1.3.1     tidyr_1.1.1    
##  [9] tibble_3.0.3    ggplot2_3.3.2   tidyverse_1.3.0
## 
## loaded via a namespace (and not attached):
##  [1] tidyselect_1.1.0   xfun_0.19          haven_2.3.1        colorspace_1.4-1  
##  [5] vctrs_0.3.2        generics_0.0.2     viridisLite_0.3.0  htmltools_0.5.0   
##  [9] yaml_2.2.1         utf8_1.1.4         blob_1.2.1         rlang_0.4.7       
## [13] pillar_1.4.6       glue_1.4.2         withr_2.2.0        DBI_1.1.0         
## [17] RColorBrewer_1.1-2 dbplyr_1.4.4       modelr_0.1.8       readxl_1.3.1      
## [21] lifecycle_0.2.0    munsell_0.5.0      blogdown_0.20      gtable_0.3.0      
## [25] cellranger_1.1.0   rvest_0.3.6        htmlwidgets_1.5.1  evaluate_0.14     
## [29] labeling_0.3       knitr_1.29         crosstalk_1.1.0.1  fansi_0.4.1       
## [33] broom_0.7.0        Rcpp_1.0.5         scales_1.1.1       backports_1.1.8   
## [37] formatR_1.7        jsonlite_1.7.0     farver_2.0.3       fs_1.5.0          
## [41] hms_0.5.3          digest_0.6.25      stringi_1.5.3      bookdown_0.20     
## [45] grid_3.6.1         cli_2.0.2          tools_3.6.1        magrittr_1.5      
## [49] lazyeval_0.2.2     crayon_1.3.4       pkgconfig_2.0.3    ellipsis_0.3.1    
## [53] data.table_1.13.0  xml2_1.3.2         reprex_0.3.0       lubridate_1.7.9   
## [57] assertthat_0.2.1   rmarkdown_2.5      httr_1.4.2         rstudioapi_0.11   
## [61] R6_2.4.1           compiler_3.6.1</code></pre>
<pre><code>## [1] &quot;2020-12-07 20:50:50 CST&quot;</code></pre>
<pre><code>##                                       sysname 
##                                       &quot;Linux&quot; 
##                                       release 
##                          &quot;4.15.0-117-generic&quot; 
##                                       version 
## &quot;#118-Ubuntu SMP Fri Sep 4 20:02:41 UTC 2020&quot; 
##                                      nodename 
##                  &quot;educcomp01.ccbb.utexas.edu&quot; 
##                                       machine 
##                                      &quot;x86_64&quot; 
##                                         login 
##                                     &quot;unknown&quot; 
##                                          user 
##                                     &quot;yl33656&quot; 
##                                effective_user 
##                                     &quot;yl33656&quot;</code></pre>
</div>

            
        <hr>         <div class="related-posts">
                <h5>Related Posts</h5>
                
              </div> 
            </div>
          </div>

   <hr>  <div class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">

    (function() {
      
      
      if (window.location.hostname == "localhost")
        return;

      var disqus_shortname = '';
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div> 
        </div>
      </div>
    </div>

    
    <footer>
  <div id="footer">
    <div class="container">
      <p class="text-muted">&copy; All rights reserved. Powered by <a href="https://gohugo.io/">Hugo</a> and
      <a href="http://www.github.com/nurlansu/hugo-sustain/">sustain</a> with ♥</p>
    </div>
  </div>
</footer>
<div class="footer"></div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="../../js/docs.min.js"></script>
<script src="../../js/main.js"></script>

<script src="../../js/ie10-viewport-bug-workaround.js"></script>


    
  </body>
</html>
